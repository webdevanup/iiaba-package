{"version":3,"file":"./js/focal-point.js","mappings":"8CAAA,IAAI,EAA+BA,OAAW,GAAc,W,oOCE5D,MASC,SAASC,EAAQC,EAAIC,GAA6B,IAA3B,IAAEC,EAAG,MAAEC,EAAK,SAAEC,GAAUH,EAC9C,IAAOD,EACN,OAGD,MAAMK,EAAOC,GAAGC,QAAQC,WAAYR,GAE9BS,EAAQ,CACbP,MACAC,QACAC,SAAYD,IACXE,EAAKN,OAAQO,GAAAC,QAAAG,cAACC,EAAAA,iBAAgBC,EAAA,GAAKH,EAAK,CAAEN,MAAQA,MAClDC,EAAUD,EAAO,GAInBE,EAAKN,OAAQO,GAAAC,QAAAG,cAACC,EAAAA,iBAAqBF,GACpC,CASA,SAASI,EAAsBC,GAAwC,IAAlCC,EAAQC,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,qBAC/C,MAAMG,EAAOb,GAAGc,MAAML,SAAUA,EAAnBT,CAA+BQ,GAE5C,IAAOA,EAAKO,OAAUP,EAAKO,KAAKC,MAAO,YACtC,OAAOH,EAGR,MAAMI,EAAMC,SAASd,cAAe,OACpCa,EAAIE,UAAYN,EAEhB,MAAMO,EAASH,EAAII,cAAe,sBAE5BC,EAAUJ,SAASd,cAAe,QACxCkB,EAAQC,UAAUC,IAAK,UAAW,eAClCF,EAAQG,QAAQH,QAAU,cAGrBF,EACJA,EAAOM,WAAWC,aAAcL,EAASF,GAEzCH,EAAIW,YAAaN,GAGlB,MAAMO,EAAQX,SAASd,cAAe,SACtCyB,EAAMN,UAAUC,IAAK,qBAAsB,QAC3CK,EAAMD,YAAaV,SAASY,eAAgB,gBAC5CR,EAAQM,YAAaC,GAErB,MAAME,EAAUb,SAASd,cAAe,QAYxC,OAXA2B,EAAQR,UAAUC,IAAK,wBACvBF,EAAQM,YAAaG,GAErBtC,EAAQsC,EAAS,CAChBnC,IAAKY,GAAMwB,OAAOC,QAAQrC,KAAOY,EAAKZ,IACtCC,MAAOW,EAAK0B,YACZpC,SAAYD,IACXsC,KAAKC,KAAM,cAAevC,EAAO,IAI5BoB,EAAIoB,QACZ,CAgCAnB,SAASoB,iBAAkB,oBAAoB,KAEzCtC,IAAIc,OAAON,MAAM+B,YAAYC,UACjCxC,GAAGc,MAAMN,KAAK+B,WAAWC,QAAUxC,GAAGc,MAAMN,KAAK+B,WAAWC,QAAQC,OAAQ,CAC3EhC,SAAU,SAAWD,GACpB,OAAOD,EAAqBmC,KAAMP,KAAM3B,EAAM,qBAC/C,KAKGR,IAAIc,OAAON,MAAM+B,YAAYC,SAASG,YAC1C3C,GAAGc,MAAMN,KAAK+B,WAAWC,QAAQG,UAAY3C,GAAGc,MAAMN,KAAK+B,WAAWC,QAAQG,UAAUF,OAAQ,CAC/FhC,SAAU,SAAWD,GACpB,OAAOD,EAAqBmC,KAAMP,KAAM3B,EAAM,gCAC/C,KAvCH,WAA2D,IAAnCd,EAAIgB,UAAAC,OAAA,QAAAC,IAAAF,UAAA,GAAAA,UAAA,GAAG,0BAG9B,GAFAhB,EAAuB,iBAATA,EAAoBwB,SAASG,cAAe3B,GAASA,GAE5DA,EACN,OAGD,MAAMkD,EAAIlD,EAAK2B,cAAe,gCACxBwB,EAAInD,EAAK2B,cAAe,gCACxByB,EAAOpD,EAAK2B,cAAe,gCAEjC5B,EAAQqD,EAAM,CACblD,IAAKkD,EAAKrB,QAAQsB,IAClBlD,MAAO,CACN+C,EAAGA,EAAE/C,MACLgD,EAAGA,EAAEhD,OAENC,SAAYD,IACX+C,EAAE/C,MAAQA,EAAM+C,EAChBC,EAAEhD,MAAQA,EAAMgD,CAAC,GAGpB,CAqBCG,EAAe,GAEhB,EAjID,E","sources":["webpack://wdg.focalPoint/external window [\"wp\",\"components\"]","webpack://wdg.focalPoint/./js/focal-point.js"],"sourcesContent":["var __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"components\"];","import { FocalPointPicker } from \"@wordpress/components\";\n\n( () => {\n\t/**\n\t * Render a focal point picker via an HTMLElement\n\t *\n\t * @param {HTMLElement} node\n\t * @param {string} props.url url\n\t * @param {object} props.value the focal point object with x and y\n\t * @param {function} props.onChange - callback for when the react component re-renders\n\t */\n\tfunction render( node, { url, value, onChange } ) {\n\t\tif ( ! node ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst root = wp.element.createRoot( node );\n\n\t\tconst props = {\n\t\t\turl,\n\t\t\tvalue,\n\t\t\tonChange: ( value ) => {\n\t\t\t\troot.render( <FocalPointPicker {...props} value={ value} /> );\n\t\t\t\tonChange( value );\n\t\t\t},\n\t\t};\n\n\t\troot.render( <FocalPointPicker {...props} /> );\n\t}\n\n\t/**\n\t * Extends a backbone view with a focal point component if the mime is image\n\t *\n\t * @param {object} view\n\t * @param {string} template\n\t * @returns {string|array}\n\t */\n\tfunction focalPointExtendView( view, template = 'attachment-details' ) {\n\t\tconst html = wp.media.template( template )( view ); // the template to extend\n\n\t\tif ( ! view.mime || ! view.mime.match( /^image\\// ) ) {\n\t\t\treturn html;\n\t\t}\n\n\t\tconst dom = document.createElement( 'div' );\n\t\tdom.innerHTML = html;\n\n\t\tconst compat = dom.querySelector( '.attachment-compat' );\n\n\t\tconst setting = document.createElement( 'span' );\n\t\tsetting.classList.add( 'setting', 'focal-point' );\n\t\tsetting.dataset.setting = 'focal_point';\n\n\t\t// try to insert as the last setting before the compat section\n\t\tif ( compat ) {\n\t\t\tcompat.parentNode.insertBefore( setting, compat );\n\t\t} else {\n\t\t\tdom.appendChild( setting );\n\t\t}\n\n\t\tconst label = document.createElement( 'label' );\n\t\tlabel.classList.add( 'focal-point__label', 'name' );\n\t\tlabel.appendChild( document.createTextNode( 'Focal Point' ) );\n\t\tsetting.appendChild( label );\n\n\t\tconst control = document.createElement( 'span' );\n\t\tcontrol.classList.add( 'focal-point__control' );\n\t\tsetting.appendChild( control );\n\n\t\trender( control, {\n\t\t\turl: view?.sizes?.medium?.url ?? view.url,\n\t\t\tvalue: view.focal_point,\n\t\t\tonChange: ( value ) => {\n\t\t\t\tthis.save( 'focal_point', value );\n\t\t\t},\n\t\t} );\n\n\t\treturn dom.children;\n\t}\n\n\t/**\n\t * Render the meta box on the attachment edit screen\n\t *\n\t * @param {string|HTMLElement} node the meta box reference\n\t * @returns void\n\t */\n\tfunction renderMetaBox( node = '#attachment-focal-point' ) {\n\t\tnode = typeof node === 'string' ? document.querySelector( node ) : node;\n\n\t\tif ( ! node ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst x = node.querySelector( 'input[name=\"focal_point[x]\"]' );\n\t\tconst y = node.querySelector( 'input[name=\"focal_point[y]\"]' );\n\t\tconst slot = node.querySelector( '#attachment-focal-point-slot' );\n\n\t\trender( slot, {\n\t\t\turl: slot.dataset.src,\n\t\t\tvalue: {\n\t\t\t\tx: x.value,\n\t\t\t\ty: y.value,\n\t\t\t},\n\t\t\tonChange: ( value ) => {\n\t\t\t\tx.value = value.x;\n\t\t\t\ty.value = value.y;\n\t\t\t},\n\t\t} );\n\t}\n\n\tdocument.addEventListener( 'DOMContentLoaded', () => {\n\t\t// select mode\n\t\tif ( wp?.media?.view?.Attachment?.Details ) {\n\t\t\twp.media.view.Attachment.Details = wp.media.view.Attachment.Details.extend( {\n\t\t\t\ttemplate: function ( view ) {\n\t\t\t\t\treturn focalPointExtendView.call( this, view, 'attachment-details' );\n\t\t\t\t},\n\t\t\t} );\n\t\t}\n\n\t\t// details mode\n\t\tif ( wp?.media?.view?.Attachment?.Details?.TwoColumn ) {\n\t\t\twp.media.view.Attachment.Details.TwoColumn = wp.media.view.Attachment.Details.TwoColumn.extend( {\n\t\t\t\ttemplate: function ( view ) {\n\t\t\t\t\treturn focalPointExtendView.call( this, view, 'attachment-details-two-column' );\n\t\t\t\t},\n\t\t\t} );\n\t\t}\n\n\t\trenderMetaBox();\n\t} );\n} )();\n"],"names":["window","render","node","_ref","url","value","onChange","root","wp","element","createRoot","props","createElement","FocalPointPicker","_extends","focalPointExtendView","view","template","arguments","length","undefined","html","media","mime","match","dom","document","innerHTML","compat","querySelector","setting","classList","add","dataset","parentNode","insertBefore","appendChild","label","createTextNode","control","sizes","medium","focal_point","this","save","children","addEventListener","Attachment","Details","extend","call","TwoColumn","x","y","slot","src","renderMetaBox"],"sourceRoot":""}