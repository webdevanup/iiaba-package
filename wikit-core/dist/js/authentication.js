!function(){var e={};!function(){"use strict";var e=JSON.parse('{"apiVersion":3,"name":"wdg/gated","title":"Gated","icon":"privacy","attributes":{"context":{"type":"boolean","default":true},"status":{"type":"string","default":"authenticated"},"restrictions":{"type":"array","items":{"type":"string"}}},"supports":{"align":false,"className":false,"customClassName":false,"color":{"gradients":false,"heading":false,"button":false,"link":false},"authentication":false},"providesContext":{"wdg/gated/context":"context","wdg/gated/status":"status","wdg/gated/restrictions":"restrictions"}}'),t=JSON.parse('{"apiVersion":3,"name":"wdg/gated-if","title":"If","parent":["wdg/gated"],"icon":"unlock","attributes":{},"supports":{"align":false,"className":false,"customClassName":false,"color":{"gradients":false,"heading":false,"button":false,"link":false},"authentication":false,"lock":false},"usesContext":["wdg/gated/status","wdg/gated/restrictions"]}'),n=JSON.parse('{"apiVersion":3,"name":"wdg/gated-else","title":"Else","parent":["wdg/gated"],"icon":"lock","attributes":{},"supports":{"align":false,"className":false,"customClassName":false,"color":{"gradients":false,"heading":false,"button":false,"link":false},"authentication":false,"lock":false},"usesContext":["wdg/gated/status","wdg/gated/restrictions"]}'),a=wdg.config.authentication,s=window.wp.blockEditor,l=window.wp.blocks,o=window.wp.compose,c=window.wp.components,i=window.wp.coreData,r=window.wp.data,u=window.wp.editor,d=window.wp.hooks,g=window.wp.plugins;function m(e){let{status:t="",filterStatus:n=null,onStatusChange:s,restriction:l=[],onRestrictionChange:o}=e,i=Object.keys(a.statuses).map((e=>({value:e,label:a.statuses[e]})));return"function"==typeof n&&(i=i.filter(n)),wp.element.createElement("div",{className:"wdg-authentication-control"},wp.element.createElement(c.RadioControl,{label:"Authentication Status",className:"wdg-authentication-control__status",selected:t,options:i,onChange:s}),wp.element.createElement("br",null),wp.element.createElement("small",{className:"wdg-authentication-control__label"},"Authentication Restrictions"),Object.keys(a.restrictions).map((e=>wp.element.createElement(c.ToggleControl,{label:a.restrictions[e].label,className:"wdg-authentication-control__restriction",key:e,disabled:"authenticated"!==t,checked:l.includes(e),onChange:t=>{t&&!l.includes(e)?o([...l,e]):!t&&l.includes(e)&&o(l.filter((t=>t!==e)))}}))))}function p(){return wp.element.createElement(s.InnerBlocks.Content,null)}function w(e){const t=(0,r.select)("core/block-editor").getBlockParents(e);if(t.length){const e=(0,r.select)("core/block-editor").getBlock(t[t.length-1]);return function(t){(0,r.dispatch)("core/block-editor").updateBlock(e.clientId,{attributes:{...e.attributes,...t}})}}return null}(0,l.registerBlockType)(e.name,{...e,save:p,edit:e=>{let{attributes:t,setAttributes:n}=e;return wp.element.createElement(wp.element.Fragment,null,wp.element.createElement(s.InspectorControls,null,wp.element.createElement(c.PanelBody,null,wp.element.createElement(m,{status:t.status,filterStatus:e=>e.value,onStatusChange:e=>n({status:e}),restriction:t.restrictions,onRestrictionChange:e=>n({restrictions:e})}))),wp.element.createElement("div",(0,s.useInnerBlocksProps)((0,s.useBlockProps)({className:"wdg-core-gated-block"}),{templateLock:"all",template:[["wdg/gated-if"],["wdg/gated-else"]]})))}}),(0,l.registerBlockType)(t.name,{...t,save:p,edit:e=>{let{context:t,clientId:n}=e;const a=t["wdg/gated/status"],l=t["wdg/gated/restrictions"],o=w(n);return wp.element.createElement(wp.element.Fragment,null,wp.element.createElement(s.InspectorControls,null,wp.element.createElement(c.PanelBody,null,wp.element.createElement(m,{status:a,filterStatus:e=>e.value,onStatusChange:e=>o({status:e}),restriction:l,onRestrictionChange:e=>o({restrictions:e})}))),wp.element.createElement("div",(0,s.useBlockProps)({className:"wdg-core-gated-block__logic wdg-core-gated-block__logic--if"}),wp.element.createElement("div",{className:"wdg-core-gated-block__header"},wp.element.createElement(c.Dashicon,{icon:"unlock"}),wp.element.createElement("span",{className:"wdg-core-gated-block__label"},"If"),wp.element.createElement("span",{className:"wdg-core-gated-block__pill wdg-core-gated-block__pill--status"},a||"Public"),"authenticated"===a&&l&&l.map((e=>wp.element.createElement("span",{key:e,className:"wdg-core-gated-block__pill wdg-core-gated-block__pill--restriction"},e)))),wp.element.createElement("div",(0,s.useInnerBlocksProps)({className:"wdg-core-gated-block__content"},{templateLock:!1,template:[["core/paragraph"]]}))))}}),(0,l.registerBlockType)(n.name,{...n,save:p,edit:e=>{let{context:t,clientId:n}=e;const a=t["wdg/gated/status"],l=t["wdg/gated/restrictions"],o=w(n);return wp.element.createElement(wp.element.Fragment,null,wp.element.createElement(s.InspectorControls,null,wp.element.createElement(c.PanelBody,null,wp.element.createElement(m,{status:a,filterStatus:e=>e.value,onStatusChange:e=>o({status:e}),restriction:l,onRestrictionChange:e=>o({restrictions:e})}))),wp.element.createElement("div",(0,s.useBlockProps)({className:"wdg-core-gated-block__logic wdg-core-gated-block__logic--else"}),wp.element.createElement("div",{className:"wdg-core-gated-block__header"},wp.element.createElement(c.Dashicon,{icon:"lock"}),wp.element.createElement("span",{className:"wdg-core-gated-block__label"},"Else")),wp.element.createElement("div",(0,s.useInnerBlocksProps)({className:"wdg-core-gated-block__content"},{templateLock:!1,template:[["core/paragraph"]]}))))}}),(0,g.registerPlugin)("wdg-core-authentication",{render:function(){const e=(0,r.useSelect)((e=>e("core/editor").getCurrentPostType())),[t,n]=(0,i.useEntityProp)("postType",e,"meta");return t?wp.element.createElement(u.PluginDocumentSettingPanel,{name:"wdg-authentication",className:"wdg-authentication",title:"Authentication",icon:"lock",initialOpen:t[a.status_key]},wp.element.createElement(m,{status:t[a.status_key],restriction:t[a.restrictions_key],onStatusChange:e=>n({...t,[a.status_key]:e}),onRestrictionChange:e=>n({...t,[a.restrictions_key]:e})})):null}}),(0,d.addFilter)("blocks.registerBlockType","wdg/authentication/register",(function(e,t){return void 0===e?.supports?.authentication&&(e.supports={...e.supports,authentication:!0}),e?.supports?.authentication&&(e.attributes={...e.attributes,[a.status_key]:{type:"string",default:"",enum:Object.keys(a.statuses)},[a.restrictions_key]:{type:"array",items:{type:"string",enum:Object.keys(a.restrictions)},default:[]}}),e.usesContext=[...e.usesContext??[],"wdg/gated/context","wdg/gated/restrictions"],e})),(0,d.addFilter)("editor.BlockEdit","wdg/authentication/edit",(0,o.createHigherOrderComponent)((function(e){return function(t){const{attributes:n,setAttributes:l,isSelected:o,context:i}=t,u=(0,r.useSelect)((e=>e("core/blocks").getBlockSupport(t.name,"authentication")));return wp.element.createElement(wp.element.Fragment,null,wp.element.createElement(e,t),u&&!i["wdg/gated/context"]&&o&&wp.element.createElement(s.InspectorControls,null,wp.element.createElement(c.PanelBody,{title:"Block Authentication",icon:"lock",initialOpen:n[a.status_key]},wp.element.createElement(m,{status:n[a.status_key],restriction:n[a.restrictions_key],onStatusChange:e=>l({[a.status_key]:e}),onRestrictionChange:e=>l({[a.restrictions_key]:e})}))))}}),"wdg/authentication/edit"),1)}();var t=wdg.authentication=void 0===wdg.authentication?{}:wdg.authentication;for(var n in e)t[n]=e[n];e.__esModule&&Object.defineProperty(t,"__esModule",{value:!0})}();
//# sourceMappingURL=authentication.js.map